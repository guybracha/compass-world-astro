---
import BaseLayout from '../layouts/BaseLayout.astro';
import '../styles/home.css';
---
<BaseLayout title="Compass World | Home" class="dark">
  <header class="cw-hero container-xxl">
    <div class="cw-hero__inner">
      <div class="cw-hero__eyebrow will-animate">Universe Wiki</div>

      <!-- ✨ טייטל עם אפקטים -->
      <h1 class="cw-hero__title js-hero-title will-animate">
        Compass World
      </h1>

      <p class="cw-hero__subtitle will-animate">
        A living sci-fi/fantasy universe by Guy Bracha — explore characters, eras, and cosmic mysteries.
      </p>

      <div class="mt-3 d-flex flex-wrap justify-content-center gap-2 will-animate">
        <a class="btn btn-brand btn-lg px-4" href="/characters/">
          <i class="bi bi-people me-2"></i> Characters
        </a>
        <a class="btn btn-ghost btn-lg px-4" href="/history/">
          <i class="bi bi-clock-history me-2"></i> Chronology
        </a>
        <a class="btn btn-outline-light btn-lg px-4" href="/prime-children/">
          Prime-Children
        </a>
      </div>
    </div>
  </header>

  <!-- השאר העמוד שלך... -->

  <!-- ✨ אנימציות לטייטל -->
  <script is:inline>
    // הופעת אלמנטים כללית (יש כבר will-animate אצלך)
    (() => {
      const els = document.querySelectorAll('.will-animate');
      const io = new IntersectionObserver((entries) => {
        entries.forEach((entry, i) => {
          if (entry.isIntersecting) {
            setTimeout(() => entry.target.classList.add('in'), i * 120);
            io.unobserve(entry.target);
          }
        });
      }, { threshold: 0.1 });
      els.forEach(el => io.observe(el));
    })();

    // ✨ אפקטים מיוחדים לכותרת
    (() => {
      const title = document.querySelector('.js-hero-title');
      if (!title) return;

      // פרק לטקנים (אותיות) עבור stagger
      const text = title.textContent.trim();
      title.textContent = '';
      [...text].forEach((ch) => {
        const span = document.createElement('span');
        span.className = 'tch';
        span.textContent = ch === ' ' ? '\u00A0' : ch;
        title.appendChild(span);
      });

      // כאשר הטייטל נכנס – הפעל stagger + shimmer + underline
      const io = new IntersectionObserver((entries) => {
        const e = entries[0];
        if (!e?.isIntersecting) return;
        title.classList.add('reveal', 'shimmer');

        const letters = title.querySelectorAll('.tch');
        letters.forEach((el, i) => {
          setTimeout(() => el.classList.add('in'), i * 25); // מהירות הסטאגר
        });

        // כבה את השימר אחרי סיבוב אחד
        setTimeout(() => title.classList.remove('shimmer'), 1600);
        io.disconnect();
      }, { threshold: 0.6 });
      io.observe(title);
    })();
  </script>

  <style>
    /* הופעת בסיס לכל will-animate */
    .will-animate { opacity: 0; transform: translateY(12px); transition: opacity .6s ease, transform .6s ease; }
    .will-animate.in { opacity: 1; transform: none; }

    /* ===== Hero Title Effects ===== */
    .cw-hero__title {
      position: relative;
      font-weight: 800;
      line-height: 1.04;
      letter-spacing: .5px;
      /* טקסט עם גרדיאנט – ייחשף באנימציה */
      background: linear-gradient(90deg, #eaecef, #ffffff 35%, #a6d3ff 60%, #ffffff);
      -webkit-background-clip: text; background-clip: text; color: transparent;
      background-size: 200% 100%;
    }

    /* קו הדגשה צבעוני שנסחף לאחר החשיפה */
    .cw-hero__title::after {
      content: "";
      position: absolute;
      left: 0; bottom: -0.2em;
      height: .18em; width: 0;
      border-radius: 999px;
      background: linear-gradient(90deg,#ffb703,#00d4ff 60%,#a855f7);
      box-shadow: 0 6px 30px rgba(0,0,0,.35), 0 0 12px rgba(168,85,247,.35);
      transition: width .6s cubic-bezier(.2,.8,.2,1) .25s;
    }
    .cw-hero__title.reveal::after { width: 100%; }

    /* שימר קצר על הגרדיאנט */
    @keyframes shimmer {
      from { background-position: 0% 50%; filter: drop-shadow(0 6px 24px rgba(0,0,0,.25)); }
      to   { background-position: 100% 50%; filter: drop-shadow(0 10px 34px rgba(0,0,0,.35)); }
    }
    .cw-hero__title.shimmer { animation: shimmer 1.4s ease-out both; }

    /* אות-אות: מצב התחלה */
    .cw-hero__title .tch {
      display: inline-block;
      opacity: 0;
      transform: translateY(18px) scale(.98);
      filter: blur(2px);
      transition: opacity .4s ease, transform .4s ease, filter .4s ease;
    }
    /* אות-אות: כניסה */
    .cw-hero__title .tch.in {
      opacity: 1;
      transform: none;
      filter: none;
    }

    /* קצת מרווח להירו */
    .cw-hero { padding-top: 5rem; padding-bottom: 2rem; }
    .cw-hero__eyebrow { text-transform: uppercase; letter-spacing: .15em; font-size: .8rem; color: #bbb; }
    .cw-hero__subtitle { color: #bfc6cf; max-width: 880px; margin: .75rem auto 0; }
  </style>
</BaseLayout>
